service: charleywong
app: charleywong
org: giffonio
frameworkVersion: ">=1.61.1"

provider:
  name: aws
  ecr:
    images:
      appimage:
        path: ./
  timeout: 30 # API Gateway has a limit of 30 seconds
  apiGateway:
    binaryMediaTypes:
      - '*/*'
  environment:
    GOOGLE_CLIENT_EMAIL: ${env:GOOGLE_CLIENT_EMAIL}
    GOOGLE_PRIVATE_KEY: ${env:GOOGLE_PRIVATE_KEY}
    FACEBOOK_TOKEN: ${env:FACEBOOK_TOKEN}

package:
  patterns:
    - '!.devcontainer/**'
    - '!.github/**'
    - '!.haxelib/**'
    - '!.vscode/**'
    - '!chrome/**'
    - '!lib/**'
    - '!src/**'
    - '!test/**'
    - '!*.py'
    - '!*.hxml'
    - '!browser.js'
    - '!chrome.*.js'

functions:
  web:
    image:
      name: appimage
    events:
      - http:
          method: ANY
          path: '/'
          cors: true
      - http:
          method: ANY
          path: '{proxy+}'
          cors: true

plugins:
  - serverless-prune-plugin

custom:
  prune:
    automatic: true
    number: 5
